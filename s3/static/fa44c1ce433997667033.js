"use strict";(self.webpackChunkcloud_trade_sdk=self.webpackChunkcloud_trade_sdk||[]).push([[1037],{11037:(e,s,i)=>{i.r(s),i.d(s,{default:()=>M});var t=i(52322),a=i(62143),o=i(91436),n=i(82040),l=i(72779),r=i.n(l),d=i(67682),c=i(36905),x=i(39428),g=i(44375),p=i(38896),u=i(37348);const m={bg:"popupBg",fontSize:"14px",".order-tabs-and-margin-type-container":{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",minHeight:"24px",pt:"10px",px:"16px",boxSizing:"border-box","&.hedge-mode":{pt:"0"},".fee-and-preference-container":{display:"flex",alignItems:"center",ml:"16px"}},".positions-tab-container":{display:"flex",flexDirection:"row",justifyContent:"space-between",bg:"moduleBg",".fee-and-preference-container":{display:"flex",alignItems:"center",justifyContent:"flex-end",flex:"1",pr:"16px",borderBottom:"1px solid",borderBottomColor:"modalBg"}},".draggable-area":{pb:"20px"},".divider":{pt:"10px",borderBottom:"1px solid",borderBottomColor:"modalBg"}},b={flex:"1",ml:"8px",mr:0},h={width:"50%",pl:"16px",mr:0},v=()=>{const[e]=(0,p.hN)(),[s]=(0,p.UI)();return(0,t.jsxs)(a.Z,Object.assign({sx:m},{children:[e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",Object.assign({className:"positions-tab-container"},{children:[(0,t.jsx)(g.default,{flex:1},void 0),(0,t.jsxs)("div",Object.assign({className:"fee-and-preference-container"},{children:[(0,t.jsx)(u.z,{},void 0),(0,t.jsx)(x.R,{},void 0)]}),void 0)]}),void 0),(0,t.jsx)("div",{className:"draggable-area draggableHandle"},void 0)]},void 0),(0,t.jsxs)("div",Object.assign({className:r()({"order-tabs-and-margin-type-container":!0,"hedge-mode":e})},{children:[(0,t.jsx)(d.Z,{},void 0),s&&(0,t.jsx)(c.default,{sx:e?h:b},void 0),!e&&(0,t.jsxs)("div",Object.assign({className:"fee-and-preference-container"},{children:[(0,t.jsx)(u.z,{},void 0),(0,t.jsx)(x.R,{},void 0)]}),void 0)]}),void 0),(0,t.jsx)("div",Object.assign({className:"draggable-area draggableHandle"},{children:!e&&(0,t.jsx)("div",{className:"divider"},void 0)}),void 0)]}),void 0)};var f=i(76308),j=i(86804),y=i(30015),C=i(81638);const O={".flex":{display:"flex",alignItems:"center",justifyContent:"space-between"},".form-subheader":{px:"16px"},".form-container":{px:"16px",pb:"16px",".buy-form, .sell-form":{width:"calc(50% - 15px)"}},".flex-row":{display:"flex",flexDirection:"row",alignItems:"center"},".reduce-only-checkbox":{mt:0,mr:"16px"},".tif-selector":{mr:"auto",mt:0},".balance-container":{flex:"1",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden","> div":{justifyContent:"flex-end"}}},M=()=>(0,t.jsxs)(a.Z,Object.assign({sx:O},{children:[(0,t.jsx)(v,{},void 0),(0,t.jsx)(C.Z,{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",Object.assign({className:"form-subheader flex-row"},{children:[(0,t.jsx)(f.W,{className:"reduce-only-checkbox"},void 0),(0,t.jsx)(j.d,{className:"tif-selector"},void 0),(0,t.jsx)("div",Object.assign({className:"balance-container"},{children:(0,t.jsx)(o.Z,{},void 0)}),void 0)]}),void 0),(0,t.jsxs)("div",Object.assign({className:"form-container flex"},{children:[(0,t.jsx)(n.Z,{horizontal:!0,side:"buy",className:"buy-form"},void 0),(0,t.jsx)(n.Z,{horizontal:!0,side:"sell",className:"sell-form"},void 0)]}),void 0)]},void 0)},void 0),(0,t.jsx)(y.Z,{},void 0)]}),void 0)},36905:(e,s,i)=>{i.r(s),i.d(s,{default:()=>P});var t=i(52322),a=i(2784),o=i(92036),n=i(45362),l=i(38896),r=i(27498),d=i(39727),c=i(48658),x=i(21209),g=i(62143),p=i(77711),u=i(5163),m=i(98569);const b=function(e){return a.createElement(m.Z,(0,u.__assign)({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none"},e),a.createElement("path",{d:"M12.723 5.248l-1.246-1.246-4.652 4.652-2.077-2.077-1.246 1.246 3.323 3.323 5.898-5.898z",fill:"currentColor"}))},h=function(e){return a.createElement(m.Z,(0,u.__assign)({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none"},e),a.createElement("path",{d:"M20.723 5.248l-1.246-1.246-4.652 4.652-2.077-2.077-1.246 1.246 3.323 3.323 5.898-5.898z",fill:"currentColor"}))};var v=i(53858),f={position:"relative",overflow:"hidden",display:"inline-flex",borderRadius:"default"},j={position:"absolute",top:0,right:0,width:0,height:0,borderStyle:"solid",borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftColor:"transparent"},y={position:"absolute",top:0,right:0,lineHeight:1},C=function(e){var s=e.children,i=e.boxProps,t=e.size,o=void 0===t?16:t,n=e.color,l=void 0===n?"primary":n,r="rtl"===(0,v.Z)();return a.createElement(g.Z,(0,u.__assign)({__css:f},i),s,a.createElement(g.Z,{__css:(0,u.__assign)((0,u.__assign)({},j),{borderWidth:"0 "+o+"px "+o+"px 0",borderRightColor:""+l})}),a.createElement(g.Z,{__css:y},r?a.createElement(b,{size:o,color:"bg1"}):a.createElement(h,{size:o,color:"bg1"})))},O=i(81993),M=i(97060),w=i(83092);const Z="CROSSED",S="ISOLATED",N={position:"relative",padding:"20px 24px 24px 24px",width:["calc(100vw - 32px)","400px"],bg:"modalBg",boxShadow:"elevation3",borderRadius:"8px",".title":{fontSize:["16px","20px"],pb:"16px",color:"t.primary"},".text":{mt:"16px",fontSize:"12px",lineHeight:"16px",color:"t.secondary",".bold":{fontWeight:"medium"},".normal":{fontWeight:"normal"}}},V=e=>{var{children:s,selected:i}=e,a=function(e,s){var i={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&s.indexOf(t)<0&&(i[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(t=Object.getOwnPropertySymbols(e);a<t.length;a++)s.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(e,t[a])&&(i[t[a]]=e[t[a]])}return i}(e,["children","selected"]);return i?(0,t.jsx)(C,Object.assign({boxProps:Object.assign({width:["47.5%","164px"]},a)},{children:(0,t.jsx)(n.Z,Object.assign({flex:1,variant:"default",colorStyle:"secondary",sx:{border:"1px solid",borderColor:"primary"}},{children:(0,t.jsx)(c.Z,Object.assign({color:"t.primary"},{children:s}),void 0)}),void 0)}),void 0):(0,t.jsx)(n.Z,Object.assign({width:["47.5%","164px"],variant:"default",colorStyle:"secondary"},a,{children:s}),void 0)},I=({title:e,visible:s,marginType:i="CROSSED",openOrders:l,symbol:r,validPositionArr:d,onClose:u,isLoggedIn:m,isUniAccount:b=!1,toLogin:h,onChange:v,enableErrorMsgIntercept:f,loginText:j,button:y,sx:C={}})=>{const{getI18n:I,i18n:{language:T="en"}}=(0,M.yk)(),[E,k]=(0,a.useState)(i),_=(0,a.useMemo)((()=>{const e=Object.values(l).filter((e=>e.symbol&&e.symbol.includes(r))).length,s=d.filter((e=>e.symbol&&e.symbol.includes(r))).length;return 0!==Number(s)||0!==Number(e)}),[l,r,d]),{enqueueNotification:z}=(0,O.Z)();(0,a.useEffect)((()=>{k(i)}),[i]);const P=(0,a.useCallback)((()=>{i!==E?(0,w.WM)({marginType:E,symbol:r}).then((({data:e,message:s})=>{if(null==e?void 0:e.marginType)k(e.marginType),u(),v&&v(e.marginType),z({header:I("changeMarginModeTitle",{defaultValue:"Adjust Margin"}),message:I("changeMarginModeSuccess",{defaultValue:"change margin mode success"}),variant:"success"});else{if(f)return;z({header:I("changeMarginModeTitle",{defaultValue:"Adjust Margin"}),message:s||I("changeMarginModeFail",{defaultValue:"change margin mode fail"}),variant:"error"})}})):u()}),[f,z,I,i,v,u,E,r]),B=(0,a.useMemo)((()=>e||`${r} ${I("MarginModeTitle",{defaultValue:"Margin Mode"})}`),[r,I,e]),R=(0,a.useCallback)((()=>{h&&h(T)}),[T,h]),A=y||V;return(0,t.jsxs)(x.Z,Object.assign({visible:s,sx:Object.assign(Object.assign({},N),C),onMaskClick:()=>u()},{children:[(0,t.jsx)(c.Z,Object.assign({variant:"headline6",className:"title"},{children:B}),void 0),(0,t.jsx)(p.Z,{sx:{position:"absolute",top:"22px",right:"24px",cursor:"pointer",color:"t.third","&:hover":{color:"t.primary"}},onClick:u},void 0),(0,t.jsxs)(o.Z,Object.assign({sx:{justifyContent:"space-between",mt:"24px"}},{children:[(0,t.jsx)(A,Object.assign({mr:"8px",selected:E===Z,onClick:()=>{k(Z)},"data-testid":"cross"},{children:I("header-Cross",{defaultValue:"Cross"})}),void 0),(0,t.jsx)(A,Object.assign({selected:E===S,onClick:()=>{b?z({message:I("uniAccountChangePosModeTip",{defaultValue:"You cannot switch to Isolated Margin Mode under Portfolio Margin mode."}),variant:"error"}):k(S)},"data-testid":"isolated"},{children:I("headerIsolated",{defaultValue:"Isolated"})}),void 0)]}),void 0),(0,t.jsxs)(c.Z,Object.assign({className:"text"},{children:["Â·"," ",I("marginModeTip",{defaultValue:"Switching margin mode only applies to the selected contract."})]}),void 0),(0,t.jsx)(g.Z,{sx:{borderTop:"1px solid",borderTopColor:"line",mt:"16px"}},void 0),(0,t.jsxs)(c.Z,Object.assign({className:"text"},{children:[(0,t.jsxs)(g.Z,Object.assign({as:"span",className:"bold"},{children:[I("crossMarginMode",{defaultValue:"Cross Margin Mode"}),":"," "]}),void 0),(0,t.jsx)(g.Z,Object.assign({as:"span",className:"normal"},{children:I("crossMarginModeComments",{defaultValue:""})}),void 0)]}),void 0),(0,t.jsxs)(c.Z,Object.assign({className:"text"},{children:[(0,t.jsxs)(g.Z,Object.assign({as:"span",className:"bold"},{children:[I("isolatedMarginMode",{defaultValue:"Isolated Margin Mode"}),":"," "]}),void 0),(0,t.jsx)(g.Z,Object.assign({as:"span",className:"normal"},{children:I("isolatedMarginModeComments",{defaultValue:""})}),void 0)]}),void 0),(0,t.jsxs)(g.Z,Object.assign({fontSize:12,mt:3,height:32,sx:{display:_?"":"none",width:"100%",color:"#F23051"}},{children:[(0,t.jsxs)("svg",Object.assign({style:{verticalAlign:"text-bottom",marginRight:"5px"},width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[(0,t.jsx)("path",{d:"M7.5 9.66406H6.5V10.6641H7.5V9.66406Z",fill:"#F23051"},void 0),(0,t.jsx)("path",{d:"M7.5 3.32617H6.5V8.66617H7.5V3.32617Z",fill:"#F23051"},void 0),(0,t.jsx)("path",{d:"M7 1C10.31 1 13 3.69 13 7C13 10.31 10.31 13 7 13C3.69 13 1 10.31 1 7C1 3.69 3.69 1 7 1ZM7\n                  0C3.135 0 0 3.135 0 7C0 10.865 3.135 14 7 14C10.865 14 14 10.865 14 7C14 3.135 10.865 0 7 0Z",fill:"#F23051"},void 0)]}),void 0),I("marginModeWarning",{defaultValue:"The margin mode cannot be changed while you have an open order/position."})]}),void 0),m?(0,t.jsx)(n.Z,Object.assign({mt:"24px",width:1,py:"10px",variant:"primary",onClick:P,disabled:_,"data-testid":"confirm"},{children:I("confirmBtn",{defaultValue:"Confirm"})}),void 0):(0,t.jsx)(n.Z,Object.assign({mt:"24px",width:1,py:"10px",variant:"primary",onClick:R,"data-testid":"margin_login"},{children:j||I("tabLogIn",{defaultValue:"LogIn"})}),void 0)]}),void 0)};var T=i(93603);const E=(0,a.memo)((({title:e,visible:s,onClose:i})=>{const o=(0,l._n)(),{preOrders:n}=(0,l.E)(),r=(0,l.F)(),[c]=(0,l.z4)(),{marginType:x}=(0,l.uO)(),g=(0,d.I0)(),p=(0,a.useCallback)((e=>{g.marginType.updateState(e)}),[]),{showWalletConnectDialog:u}=(0,T.dc)(),{getI18n:m}=(0,M.HK)();return(0,t.jsx)(I,{title:e,marginType:x,openOrders:n,symbol:c,validPositionArr:r,toLogin:u,loginText:m("dex-header-ConnectWallet",{defaultValue:"Connect Wallet"}),visible:s,onClose:i,isLoggedIn:o,isUniAccount:!1,onChange:p,enableErrorMsgIntercept:!0},void 0)})),k=a.memo((({sx:e={},labelSx:s={},className:i})=>{var d,c;const x="rtl"===(0,l.gm)(),{getI18n:g}=(0,M.yk)(),[p]=(0,l.z4)(),{contractType:u}=(0,l.j2)(),{curLeverage:m=20}=(0,l.rf)(),{marginType:b="CROSSED"}=(0,l.uO)(),[h,v]=(0,a.useState)(!1),[f,j]=(0,a.useState)(!1);let y;const C=p.split("_");return y=y=`${null==C?void 0:C[0]} ${"PERPETUAL"===u?g("inversePerpetual",{defaultValue:"Perpetual"}):(null===(d=null==C?void 0:C[1])||void 0===d?void 0:d.substr(2))||""}`,x&&(y=y=`${"PERPETUAL"===u?g("perpetual",{defaultValue:"Perpetual"}):(null===(c=null==C?void 0:C[1])||void 0===c?void 0:c.substr(2))||""}${null==C?void 0:C[0]}`),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Z,Object.assign({sx:e,className:i},{children:[(0,t.jsx)(n.Z,Object.assign({variant:"default",colorStyle:"secondary",title:"CROSSED"===b?g("header-Cross",{defaultValue:"Cross"}):g("headerIsolated",{defaultValue:"Isolated"}),as:"a",onClick:()=>{v(!0)},"data-testid":"Cross",sx:s},{children:"CROSSED"===b?g("header-Cross",{defaultValue:"Cross"}):g("headerIsolated",{defaultValue:"Isolated"})}),void 0),(0,t.jsx)(n.Z,Object.assign({variant:"default",colorStyle:"secondary",as:"a",onClick:()=>j(!0),"data-testid":"20x",sx:s},{children:`${m}x`}),void 0)]}),void 0),h&&(0,t.jsx)(E,{title:`${y} ${g("MarginModeTitle",{defaultValue:"Margin Mode"})}`,visible:!0,onClose:()=>{v(!1)}},void 0),f&&(0,t.jsx)(r.Z,{visible:!0,onClose:()=>j(!1)},void 0)]},void 0)})),_={flex:1,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"64px",height:"24px",fontSize:"xs",lineHeight:"24px",padding:0,mr:"5px",textAlign:"center",cursor:"pointer",display:"inline-block",px:"4px",py:0,bg:"line",a:{color:"t.primary"}},z={ml:"8px",mr:"20px",minWidth:"auto"};function P({sx:e={},labelSx:s={},className:i}){const o=(0,a.useMemo)((()=>Object.assign(Object.assign({},z),e)),[e]),n=(0,a.useMemo)((()=>Object.assign(Object.assign({},_),s)),[s]);return(0,t.jsx)(k,{sx:o,labelSx:n,className:i},void 0)}}}]);