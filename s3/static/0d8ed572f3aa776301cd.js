"use strict";(self.webpackChunkcloud_trade_sdk=self.webpackChunkcloud_trade_sdk||[]).push([[1451],{1451:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Oe});var n=i(52322),o=i(77376),s=i(10847),a=i(21627),r=i(14485),l=i(61750),d=i(51336),c=i(92036),m=i(5163),p=i(2784),u=i(29261),h=i(34656);function x(e,t){const i=new Date,n=i.setHours(24,0,0,0),o=`get${e}`;return{startTime:i[`set${e}`](i[o]()-t),endTime:n}}const y={"1d":{label:"1 Day",getTimes:()=>x("Date",1)},"1w":{label:"1 Week",getTimes:()=>x("Date",7)},"1m":{label:"1 Month",getTimes:()=>x("Month",1)},"3m":{label:"3 Months",getTimes:()=>x("Month",3)}};var b=i(53096),g=i(4028),f=i(97060);const v=e=>(0,f.ZK)("trd-tradeTransaction",e);var j=i(48658),w=i(977);const T=({children:e})=>(0,n.jsx)(j.Z,Object.assign({variant:"caption",__css:{color:"t.third"}},{children:e}),void 0),O=e=>{var{color:t="t.primary"}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,["color"]);return(0,n.jsx)(j.Z,Object.assign({variant:"captionSub",color:t},i),void 0)},S=({children:e,sx:t})=>(0,n.jsx)(c.Z,Object.assign({className:"row-item",sx:t},{children:e}),void 0),M=({symbol:e,time:t,balanceDelta:i,balancetype:n,showSymbolColumn:o},s,a)=>{const r=[{columnKey:"amount",text:"Amount",i18n:"amount",value:i},{columnKey:"type",text:"Type",i18n:"type",value:s(`bt-${n}`,{defaultValue:n})},{columnKey:"time",text:"Time",i18n:"time",value:(0,w.v)(new Date(t),"yyyy-MM-dd hh:mm:ss")}];return o?[...r,{columnKey:"symbol",text:"Symbol",i18n:"symbol",value:e?(0,h.t9)(e,a):"-"}]:r},C=p.memo((e=>{const{getI18n:t}=v(),{getI18n:i}=(0,f.yk)(),o=M(e,t,i);return(0,n.jsxs)("div",Object.assign({className:"row-wrap"},{children:[(0,n.jsx)(S,Object.assign({sx:{pb:"10px !important"}},{children:e.asset}),void 0),o.map((({i18n:e,text:i,value:o,columnKey:s})=>(0,n.jsxs)(S,{children:[(0,n.jsx)(T,{children:t(e,{defaultValue:i})},void 0),(0,n.jsx)(O,{children:o},void 0)]},s)))]}),void 0)})),Z=p.memo((e=>{const{getI18n:t}=v(),{getI18n:i}=(0,f.yk)(),o=M(e,t,i);return(0,n.jsxs)("div",Object.assign({className:"row-wrap"},{children:[(0,n.jsx)(S,Object.assign({sx:{pb:"10px !important"}},{children:e.asset}),void 0),(0,n.jsx)("div",Object.assign({className:"row-grid"},{children:o.map((({i18n:e,text:i,value:o,columnKey:s})=>(0,n.jsxs)("div",Object.assign({className:s},{children:[(0,n.jsx)(T,{children:t(e,{defaultValue:i})},void 0),(0,n.jsx)(O,{children:o},void 0)]}),s)))}),void 0)]}),void 0)})),I={position:"relative",flexDirection:"column",flex:"1 0",".empty":{display:"flex",minHeight:120,alignItems:"center",justifyContent:"center",color:"t.secondary",fontSize:0},".row-wrap":{color:"t.primary",py:15,borderBottom:"1px solid",borderColor:"line","&:last-of-type":{mb:102,borderBottom:"none"},"& .row-item":{justifyContent:"space-between",alignItems:"center",py:"minor"}}},k={position:"relative",flexDirection:"column",height:"100%",".empty":{display:"flex",minHeight:120,alignItems:"center",justifyContent:"center",color:"t.secondary",fontSize:0},".row-list":{height:"calc(100% - 32px)",overflow:"auto","&::-webkit-scrollbar":{display:"none"},"&::-webkit-scrollbar-thumb":{bg:"transparent"}},".row-wrap":{color:"t.primary",py:15,borderBottom:"1px solid",borderColor:"line","&:last-of-type":{mb:15,borderBottom:"none"},".row-grid":{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"repeat(2, 1fr)",gridGap:"12px 16px",gridTemplateAreas:'"amount type"\n        "time symbol"',"& .type, & .symbol":{textAlign:"right"}},"& .row-item":{justifyContent:"space-between",alignItems:"center"}}};var P=i(62143),R=i(55742),A=i(37407),E=i(72779),W=i.n(E);const D={ml:"16px",width:["176px","auto","176px"],borderRight:"1px solid",borderRightColor:"newLine",".filter-placeholder":{display:"flex",alignItems:"center",color:"t.third",fontSize:"14px",".filter-label":{maxWidth:"155px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}},F={height:"312px",overflow:"auto",py:"4px",mt:"6px",bg:"modalBg",boxShadow:"elevation2",borderRadius:"4px",cursor:"pointer",".filter-option":{padding:"10px 16px",color:"t.primary","&:hover":{bg:"line"},"&.active":{color:"t.yellow"},fontSize:"14px"}},L=({balanceType:e,onFilterChange:t})=>{const{getI18n:i}=v();return(0,n.jsx)(P.Z,Object.assign({sx:D},{children:(0,n.jsx)(R.ZP,Object.assign({trigger:"hover",enablePortal:!0,overlay:(0,n.jsx)(P.Z,Object.assign({sx:F},{children:h.Wm.map((o=>(0,n.jsx)("div",Object.assign({className:W()({"filter-option":!0,active:o===e}),onClick:()=>{t(o)}},{children:"ALL"===o?i("ALL",{defaultValue:"All"}):i(`bt-${o}`,{defaultValue:o})}),o)))}),void 0)},{children:(0,n.jsxs)("div",Object.assign({className:"filter-placeholder"},{children:[(0,n.jsx)("div",Object.assign({className:"filter-label"},{children:"ALL"===e?i("ALL",{defaultValue:"All"}):i(`bt-${e}`,{defaultValue:e})}),void 0),(0,n.jsx)(A.Z,{ml:"4px",color:"t.third",size:16},void 0)]}),void 0)}),void 0)}),void 0)};var N=i(23131),_=i(44951),B=i(38254),V=i(10015);const z=N.K3.transactionhistory,H=({onReset:e,type:t,endTime:i,startTime:o,onSearch:s,balanceType:a,onFilterChange:r})=>{const{isMobile:l}=(0,f.Fs)(),{getI18n:d}=(0,f.Vw)(),m="number"==typeof i&&"number"==typeof o;return l?(0,n.jsx)(V.Z,{onSearch:s,isTransaction:!0,onTransactionFilterChange:r},void 0):(0,n.jsxs)(c.Z,Object.assign({sx:{alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",height:"32px"}},{children:[(0,n.jsx)(B.Z,Object.assign({withReset:!0,onReset:e,type:t,onSearch:s},{children:(0,n.jsx)(L,{balanceType:a,onFilterChange:r},void 0)}),void 0),m&&(0,n.jsx)(_.Z,{dateTime:{startTime:o,endTime:i},downloadUrl:z.uri,title:d(z.key)},void 0)]}),void 0)},K=()=>{const{getI18n:e}=v();return(0,n.jsx)("div",Object.assign({className:"empty"},{children:e("nodata",{defaultValue:"You have no trades."})}),void 0)},$=p.memo((({isMobile:e,isEmpty:t,hasMore:i,loadMore:o,showSymbolColumn:s,loading:a,data:r=[],filterType:l,balanceType:d,onFilterChange:m,onSearch:u,onReset:h})=>((0,p.useEffect)((()=>{i&&o()}),[i,o]),(0,n.jsxs)(c.Z,Object.assign({sx:e?I:k},{children:[(0,n.jsx)(b.Z,{fullScreen:!0,show:a},void 0),(0,n.jsx)(H,{onReset:h,type:l,onSearch:u,balanceType:d,onFilterChange:m},void 0),t?(0,n.jsx)(K,{},void 0):e?r.map((e=>(0,n.jsx)(C,Object.assign({},e,{showSymbolColumn:s}),e.tranId))):(0,n.jsx)("div",Object.assign({className:"row-list"},{children:r.map((e=>(0,n.jsx)(Z,Object.assign({},e,{showSymbolColumn:s}),e.tranId)))}),void 0),i&&(0,n.jsx)(g.Z,{showMore:o,check:{offset:200},loading:a},void 0)]}),void 0))));var G=i(7688),U=i(21248),Q=i(44613);const Y=p.memo((({loading:e=!1,data:t,renderRow:i,empty:o,isEmpty:s,hasMore:a,loadMore:r,showSymbolColumn:l,rowHeight:d=80,minWidth:c=0,sx:m})=>{const h=(0,p.useRef)({data:t,flag:-1});h.current.data!==t&&(h.current.flag*=-1),h.current.data=t;const x=(0,p.useRef)(null),y=(0,u.tZ)(),g=(0,Q.cp)(y);(0,p.useEffect)((()=>{if(!x.current)return;const{listRef:e}=x.current;if(!e||!e.current)return;const{current:t}=e;t.resetAfterIndex(0,!0)}),[h.current.flag]);const f=(0,p.useMemo)((()=>[{title:"",dataIndex:"",hideTitle:!0,render:(e,t)=>i(e,t,l)}]),[l,i]);return s?(0,n.jsx)(p.Fragment,{children:o},void 0):(0,n.jsxs)(P.Z,Object.assign({sx:Object.assign({position:"relative",".list-grid":{width:"100%","> div > div":{border:0,"> div":{my:0,px:0,height:"100%",borderBottom:"1px solid",borderBottomColor:"newLine"}}}},m)},{children:[(0,n.jsx)(b.Z,{fullScreen:!0,inner:!0,show:e},void 0),(0,n.jsx)(G.Z,{children:({height:e,width:i})=>(0,n.jsx)(U.Z,{style:{direction:g},threshold:5,hasMore:a,loadMore:r,className:"list-grid",columns:f,ref:x,data:t,listGridConfig:{collapseHeight:d,height:Math.max(e-4,0),width:Math.max(i,c)},__hackDataChanged:h.current.flag},void 0)},void 0)]}),void 0)}));var q=i(54163);const X={my:0,py:"xs",width:"calc(100% - 5px)",display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,color:"t.primary",fontSize:[0],cursor:"auto"},J={userSelect:"none",px:"xs",flexGrow:1,fontWeight:"normal",whiteSpace:"nowrap"},ee={time:{minWidth:"120px"},type:{minWidth:"90px"},amount:{minWidth:"100px"},asset:{minWidth:"50px"},symbol:{minWidth:"125px"}},te=Object.keys(ee).reduce(((e,t)=>e+parseInt(ee[t].minWidth,10)),0),ie=e=>{const t=ee[e]||{};return Object.assign(Object.assign(Object.assign({},J),t),{flexBasis:t.minWidth})},ne=p.memo((({time:e,balanceDelta:t,balancetype:i,asset:o,symbol:s,showSymbolColumn:a})=>{const{getI18n:r}=v(),{getI18n:l}=(0,f.yk)();return(0,n.jsxs)(c.Z,Object.assign({sx:Object.assign(Object.assign({},X),{color:"t.primary",fontSize:[0],cursor:"auto",py:0,width:"100%"})},{children:[(0,n.jsx)(j.Z,Object.assign({sx:Object.assign(Object.assign({},ie("time")),{color:"table.timeColor"})},{children:(0,w.v)(new Date(e),"yyyy-MM-dd hh:mm:ss")}),void 0),(0,n.jsx)(j.Z,Object.assign({sx:ie("type")},{children:r(`bt-${i}`,{defaultValue:i})}),void 0),(0,n.jsx)(j.Z,Object.assign({sx:ie("amount")},{children:(0,q.uf)(t,8)}),void 0),(0,n.jsx)(j.Z,Object.assign({sx:ie("asset")},{children:o}),void 0),a?(0,n.jsx)(j.Z,Object.assign({sx:ie("symbol")},{children:s?(0,h.t9)(s,l):"-"}),void 0):null]}),void 0)})),oe=[{key:"time",text:"Time",i18n:"time"},{key:"type",text:"Type",i18n:"type"},{key:"amount",text:"Amount",i18n:"amount"},{key:"asset",text:"Asset",i18n:"asset"}],se=[...oe,{key:"symbol",text:"Symbol",i18n:"symbol"}],ae=(e,t,i)=>(0,n.jsx)(ne,Object.assign({},t,{showSymbolColumn:i}),void 0),re=()=>{const{getI18n:e}=v();return(0,n.jsx)(P.Z,Object.assign({sx:{color:"t.secondary",textAlign:"center",fontSize:[0],marginTop:"xs"}},{children:e("nodata",{defaultValue:"You have no trades."})}),void 0)},le=p.forwardRef((({isEmpty:e,hasMore:t,loadMore:i,showSymbolColumn:o,loading:s,data:a=[]},r)=>{const{getI18n:l}=v(),d=(0,p.useMemo)((()=>(0,n.jsx)(c.Z,Object.assign({sx:Object.assign(Object.assign({},X),{borderBottom:"1px solid",borderBottomColor:"newLine"})},{children:(o?se:oe).map((e=>(0,n.jsx)(P.Z,Object.assign({sx:ie(e.key)},{children:(0,n.jsx)(j.Z,Object.assign({sx:{fontSize:0,color:"t.third"}},{children:l(e.i18n,{defaultValue:e.text})}),void 0)}),e.key)))}),void 0)),[l,o]);return(0,n.jsxs)(c.Z,Object.assign({ref:r,sx:{flexDirection:"column",flex:"1 0",overflowX:"auto"}},{children:[d,(0,n.jsx)(Y,{sx:{flex:"1 0"},loading:s,rowHeight:40,renderRow:ae,data:a,hasMore:t,loadMore:i,showSymbolColumn:o,isEmpty:e,empty:(0,n.jsx)(re,{},void 0),minWidth:te},void 0)]}),void 0)})),de=p.memo((({filterType:e,onReset:t,onSearch:i,balanceType:o,onFilterChange:s,hasMore:a,loadMore:r,showSymbolColumn:l,isEmpty:d,data:c,loading:m,currentPage:u,endTime:x,startTime:y})=>{const b=function(e){const t=(0,p.useRef)(null);return(0,p.useEffect)((()=>{if(e!==h.li)return;const{current:i}=t;if(i&&i instanceof Element){const e=i.querySelector(".list-grid");e&&(e.scrollTop=0)}})),t}(u);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P.Z,{children:(0,n.jsx)(H,{onReset:t,type:e,endTime:x,startTime:y,onSearch:i,balanceType:o,onFilterChange:s},void 0)},void 0),(0,n.jsx)(le,{ref:b,hasMore:a,loadMore:r,showSymbolColumn:l,isEmpty:d,data:c,loading:m},void 0)]},void 0)}));var ce=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,r)}l((n=n.apply(e,t||[])).next())}))};const me=["TRANSFER","WITHDRAW","DEPOSIT"],pe=["COIN_SWAP_WITHDRAW","COIN_SWAP_DEPOSIT"],ue="Init",he="UpdateFilter",xe="UpdateBalanceType",ye="FetchSuccess",be={nextPage:h.li,hasMore:!0,balanceType:"ALL",filters:{timePeriod:h.Bs,startTime:0,endTime:0},items:[],symbolMap:{}},ge=(0,s.j)({[ue](e){const{symbolMap:t,items:i}=e;return Object.assign(Object.assign({},be),{items:i,symbolMap:t})},[xe](e,t){const{type:i}=t.payload;e.balanceType=i},[he](e,t){const{startTime:i,endTime:n,timePeriod:o}=t.payload;void 0!==o&&(e.filters.timePeriod=o),void 0!==i&&(e.filters.startTime=i),void 0!==n&&(e.filters.endTime=n)},[ye](e,t){const{data:i,page:n}=t.payload;n===h.li?e.items=i:i.length&&(e.items=e.items.concat(i)),e.hasMore=i.length>0,e.nextPage=n+1}},be),fe=(0,a.Z)(he),ve=(0,a.Z)(xe),je=(0,a.Z)(ye),we=(0,a.Z)(ue);const Te=()=>()=>Promise.resolve(),Oe=p.memo((({active:e=!1})=>{const t=(0,u.AM)(),[i,s]=(0,p.useReducer)(ge,Object.assign(Object.assign({},be),{symbolMap:t})),{nextPage:a,filters:x,hasMore:b}=i,{items:g=[],balanceType:f}=i;let v=(0,r.I9)(g);"TRANSFER"===f?v=g.filter((e=>-1!==me.indexOf(null==e?void 0:e.balancetype))):"COIN_SWAP"===f?v=g.filter((e=>-1!==pe.indexOf(null==e?void 0:e.balancetype))):f&&"ALL"!==f&&(v=g.filter((e=>(null==e?void 0:e.balancetype)===f)));const j="ALL"===f||v.some((e=>null==e?void 0:e.symbol)),{startTime:w,endTime:T}=function(e){let t=function(e){const t=y[e];return t?t.getTimes():null}(e.timePeriod);return t||(t={startTime:e.startTime,endTime:e.endTime}),t}(x),[O,S]=(0,p.useState)(Te),[{loading:M},C]=(0,l.Z)((({page:e=h.li,times:t}={})=>ce(void 0,void 0,void 0,(function*(){const{startTime:i,endTime:n}=t||{startTime:w,endTime:T};if(S(Te),null===i||null===n)return;const{data:o}=yield(({startTime:e,endTime:t,rows:i,page:n}={})=>ce(void 0,void 0,void 0,(function*(){let o;try{o=yield(0,d.v_)("/bapi/futures/v1/private/future/user-data/transaction-history",{startTime:e,endTime:t-1,page:n,rows:i})}catch(e){throw new Error("nework error")}if("000000"!==o.code)throw new Error(o.message||"unknown error");return{data:o.data||[],total:o.total}})))({startTime:i,endTime:n,page:e,rows:h.n});s(je({data:o,page:e}))}))),[w,T],{loading:!0});var Z,I;(0,p.useEffect)((Z=()=>{S((()=>()=>C({page:a})))},100,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=+new Date;(!I||i-I>100)&&(Z.call.apply(Z,(0,m.__spreadArray)([null],e)),I=i)}),[C,a]);const k=(0,p.useCallback)((({type:e,startTime:t,endTime:i})=>{s(fe({timePeriod:e,startTime:t,endTime:i})),C({page:h.li,times:{startTime:t,endTime:i}})}),[C]),P=e=>s(ve({type:e})),R=()=>{s(we()),k((0,r.OQ)("1d"))},A=!M&&g.length<=0;return(0,p.useEffect)((()=>{e&&k((0,r.OQ)("1d"))}),[e]),(0,n.jsx)(c.Z,Object.assign({sx:{flexDirection:"column",height:"100%",pb:"xs",px:"sm"}},{children:(0,n.jsx)(o.Z,{children:({isMobile:e,isIPad:t})=>t?(0,n.jsx)($,{isMobile:e,hasMore:b,loadMore:O,showSymbolColumn:j,isEmpty:A,data:v,loading:M,filterType:x.timePeriod,balanceType:f,onFilterChange:P,onReset:R,onSearch:k},void 0):(0,n.jsx)(de,{filterType:x.timePeriod,onSearch:k,balanceType:f,onFilterChange:P,onReset:R,hasMore:b,loadMore:O,showSymbolColumn:j,isEmpty:A,data:v,loading:M,currentPage:a-1,startTime:w,endTime:T},void 0)},void 0)}),void 0)}))},77376:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(33656);const o=({children:e})=>{const{isMobile:t,isIPad:i}=(0,n.F)();return e&&e({isMobile:t,isIPad:i})}},10847:(e,t,i)=>{i.d(t,{j:()=>s});var n=i(24220),o=i(15729);const s=(e,t)=>(0,n.Z)(Object.keys(e).reduce(((t,i)=>Object.assign(Object.assign({},t),{[i]:(t,n)=>(0,o.ZP)(t,(t=>e[i](t,n)))})),{}),t)}}]);