(self.webpackChunkcloud_trade_sdk=self.webpackChunkcloud_trade_sdk||[]).push([[6137],{18495:(e,t,n)=>{"use strict";n.d(t,{a:()=>q,H:()=>R});var i,r=n(5163),a=n(2784),o=n(13980),s=n.n(o),l=n(8301),c=n(12436),d=n.n(c),m=n(61049),u=n.n(m),h=n(18149),f=n.n(h),p=n(62143),g=n(72779),y=n.n(g),v=n(20573),x=n(7688),b=n(28316),S=n(10687),w={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},E=(0,a.memo)((function(e){var t=e.show,n=void 0===t||t,i=e.fullScreen,o=void 0!==i&&i,s=e.inner,l=e.children,c=e.zIndex;if(!n)return l||null;var d=a.createElement(S.Z,{sx:(0,r.__assign)({zIndex:c||"100"},w)});return o?a.createElement(a.Fragment,null,l,a.createElement("div",{style:{position:s?"absolute":"fixed",top:0,left:0,width:"100%",height:"100%",background:"radial-gradient(rgba(0, 0, 0, 0.05) 30%, transparent)",zIndex:2e3}},d)):a.createElement(a.Fragment,null,l,d)}));E.show=function(e){var t=(void 0===e?{}:e).fullScreen,n=void 0!==t&&t;i||(i=document.createElement("div"),document.body.appendChild(i)),b.render(a.createElement(E,{fullScreen:n}),i)},E.hide=function(){i&&b.render(a.createElement(E,{show:!1}),i)};const j=E;var C={fontSize:0,textAlign:"center",padding:"8px 6px",color:"t.third"};const k=(0,a.memo)((function(e){var t=e.children,n=(0,r.__rest)(e,["children"]);return a.createElement(p.Z,(0,r.__assign)({sx:C,className:"emptyLine"},n),t)}));var T=n(44613),M=n(74628),O=n(76699),I=function(){var e=(0,O.$)().i18n.language||"undefined"!=typeof window&&window.localStorage.i18nextLng||"en";return(0,M.yV)(e)};l.t7.displayName="FixedSizeList";var D,_,H,R=(0,a.memo)((function(e){var t=e.className,n=e.children,i=(0,r.__rest)(e,["className","children"]),o=y()("list-item-entity",t);return a.createElement(a.Fragment,null,a.createElement("div",(0,r.__assign)({className:o},i),n),a.createElement(v.xB,{styles:{".list-item-entity":{display:"flex",alignItems:"center",justifyContent:" space-between",flex:1}}}))})),A=function(){},N=(0,r.__read)([38,40],2),L=N[0],P=N[1],K=function(e){function t(t){var n,i=e.call(this,t)||this;return i.state={isScrolling:!1,isHover:!1,activeId:0,scrollOffset:0},i.renderItem=function(e){var t=e.index,n=e.style,o=i.props,s=o.dataSource,l=o.itemElement,c=o.openShotCut,d=i.state.activeId,m=!!c&&d===t;return a.createElement(a.Fragment,null,a.createElement("div",{style:n,className:"list-item-container"},a.createElement(l,(0,r.__assign)({},s[t],{activeId:d,active:m}))),a.createElement(v.xB,{styles:{".list-item-container":{display:"flex",alignItems:"center",overflowX:"hidden"}}}))},i.renderChild=function(){var e=i.props,t=e.dataSource,n=void 0===t?[]:t,o=e.itemKey,s=e.itemHeight,c=e.loading,d=void 0!==c&&c,m=e.loadWithContent,u=void 0!==m&&m,h=e.direction,f=e.listSx,p=void 0===f?{}:f,g=e.emptyText,y=e.emptyChildren,v=i.state.isScrolling,b=!d&&0===n.length;i.ListStyle=(0,r.__assign)({direction:h},p);var S=a.createElement(x.Z,{className:"list-auto-sizer"},(function(e){var t=e.width,c=e.height;return a.createElement(l.t7,{style:(0,r.__assign)({direction:h},p),className:"fixed-size-list",width:t,height:c,itemCount:n.length,itemSize:s,itemData:n,itemKey:o,overscanCount:v?10:1,outerRef:i.outerListRef,innerRef:i.innerListRef,useIsScrolling:!0},i.renderItem)}));return d?u?a.createElement(a.Fragment,null,a.createElement(j,{fullScreen:!0,inner:!0}),S):a.createElement(j,{fullScreen:!0,inner:!0}):b?a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexGrow:1}},y||(g?a.createElement(k,null,g):null)):S},i.handleScroll=d()(i.handleScroll.bind(i),200),i.handleMouseEnter=i.handleMouseEnter.bind(i),i.handleMouseLeave=i.handleMouseLeave.bind(i),i.handleKeyDown=i.handleKeyDown.bind(i),i.keyScroll=i.keyScroll.bind(i),i.outerListRef=a.createRef(null),i.innerListRef=a.createRef(null),i.maxHeight=t.itemHeight,i.minHeight=.1,i.eventAttached=!1,i.keys=((n={})[L]=0,n[P]=0,n),i}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.openShotCut&&(this.eventAttached=!0,document.addEventListener("keydown",this.handleKeyDown),this.keyScroll())},t.prototype.componentDidUpdate=function(){this.props.openShotCut&&(this.eventAttached||document.addEventListener("keydown",this.handleKeyDown),this.keyScroll())},t.prototype.componentWillUnmount=function(){this.eventAttached&&(this.eventAttached=!1,document.removeEventListener("keydown",this.handleKeyDown)),this.clearTimer()},t.prototype.shouldComponentUpdate=function(e,t){var n=f()(e.dataSource,this.props.dataSource);return n?e.loading!==this.props.loading||e.itemHeight!==this.props.itemHeight||e.listSx!==this.props.listSx:!(n||!this.props.changeOnDataSourceUpdate)||(!t.isScrolling||!this.state.isScrolling)&&t.isHover===this.state.isHover},t.prototype.handleMouseEnter=function(){this.setState({isHover:!0})},t.prototype.handleMouseLeave=function(){this.setState({isHover:!1})},t.prototype.handleScroll=function(){var e=this;this.state.isHover&&(this.setState({isScrolling:!0}),this.clearTimer(),this.timer=setTimeout((function(){e.setState({isScrolling:!1})}),1e3))},t.prototype.clearTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.handleKeyDown=function(e){var t,n=e.keyCode,i=e.metaKey,r=e.ctrlKey,a=this.props,o=a.itemHeight,s=a.dataSource,l=a.openShotCut,c=a.onKeyDownCallback,d=a.tradeType,m=this.state.activeId;if(l&&(13===n||n===L||n===P)&&(e&&e.preventDefault(),e.stopPropagation(),this.keys=((t={})[L]=Math.max(this.minHeight,this.state.scrollOffset-o),t[P]=Math.min(this.state.scrollOffset+o,this.maxHeight),t),this.keys[n]&&this.scrollItem(this.keys[n]),13===n)){var h=s.filter((function(e,t){return t===m})),f=h.length?h[0]:{};u()(c)&&c({data:f,metaKey:i,ctrlKey:r,tradeType:d})}},t.prototype.keyScroll=function(){this.innerListRef.current&&(this.maxHeight=this.innerListRef.current.style.height.replace("px","")||this.props.itemHeight),this.outerListRef.current&&this.outerListRef.current.scrollTo({left:0,top:this.state.scrollOffset,behavior:"auto"})},t.prototype.scrollItem=function(e){this.setState({activeId:Math.floor(e/this.props.itemHeight),scrollOffset:e})},t.prototype.render=function(){var e=this.props,t=e.variant,n=e.sx,i=e.tx,r=e.scrollPerf,o=void 0===r||r;return a.createElement(p.Z,{onScroll:o?this.handleScroll:A,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,__css:{position:"relative",display:"flex",flexDirection:"column",flexGrow:1},className:"list-container",variant:t,sx:n,tx:i},this.renderChild())},t.propTypes={dataSource:s().array.isRequired,itemElement:s().elementType.isRequired,itemHeight:s().number.isRequired,itemKey:s().func,sx:s().object,tx:s().string,variant:s().string,loading:s().bool,openShotCut:s().bool,onKeyDownCallback:s().func,emptyText:s().string,tradeType:s().string,changeOnDataSourceUpdate:s().bool},t}(a.Component),q=(_=(D=K).displayName||D.name||"Component",(H=function(e){var t,n=(t=I(),(0,T.cp)(t));return a.createElement(D,(0,r.__assign)({},e,{direction:n}))}).displayName="WithDirection("+_+")",H)},977:(e,t,n)=>{"use strict";function i(e,t,n){void 0===t&&(t="yyyy-MM-dd hh:mm"),void 0===n&&(n=!1);var i=n?{"M+":e.getUTCMonth()+1,"d+":e.getUTCDate(),"h+":e.getUTCHours(),"m+":e.getUTCMinutes(),"s+":e.getUTCSeconds(),"q+":Math.floor((e.getUTCMonth()+3)/3),S:e.getUTCMilliseconds()}:{"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},r=t;return/(y+)/.test(t)&&(r=t.replace(RegExp.$1,(""+e.getFullYear()).substr(4-RegExp.$1.length))),Object.keys(i).forEach((function(e){new RegExp("("+e+")").test(r)&&(r=r.replace(RegExp.$1,1===RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)))})),r}n.d(t,{v:()=>i})},18149:(e,t,n)=>{var i=n(88746);e.exports=function(e,t){return i(e,t)}},12436:(e,t,n)=>{var i=n(54073),r=n(29259);e.exports=function(e,t,n){var a=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return r(n)&&(a="leading"in n?!!n.leading:a,o="trailing"in n?!!n.trailing:o),i(e,t,{leading:a,maxWait:t,trailing:o})}},46137:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>K});var i=n(52322),r=n(2784),a=n(17160),o=n(5163),s=n(92036);const l=r.memo((function(e){var t=e.headers;return r.createElement(s.Z,{sx:{alignItems:"center",justifyContent:"space-between","& .left":{textAlign:"left"},"& .right":{textAlign:"right"},"> div":{alignItems:"center",userSelect:"none",height:"16px",fontSize:0,color:"t.third",overflow:"hidden",textOverflow:"ellipsis",display:"block",flex:"1"},px:["0","sm"],py:"8px"}},t.map((function(e,t){return r.createElement(s.Z,{key:t,className:e.area},e.text)})))}));var c={"& .trade-list-item":{padding:"0 12px 0 16px !important",cursor:"pointer",fontSize:0,fontWeight:"normal","& .left":{textAlign:"left",justifyContent:"flex-start",flex:1},"& .right":{textAlign:"right",justifyContent:"flex-end",color:"t.secondary",flex:1},"&-buy .price":{color:"t.buy"},"&-sell .price":{color:"t.sell"},"& .text":{color:"t.secondary"},"& .time":{color:"t.secondary"},"@media screen and (max-width: 768px)":{padding:"0 !important"}}},d=n(18495);const m=r.memo((function(e){var t=e.trades,n=e.loading,i=e.itemHeight,a=void 0===i?18:i,o=e.tradeItem,s=e.emptyText;return r.createElement(d.a,{sx:c,dataSource:t,loading:n,itemElement:o,itemHeight:a,emptyText:s})}));var u=n(977);const h=r.memo((function(e){var t=e.price,n=e.buyerIsMaker,i=e.quantity,a=e.tradeTime,o=e.formatPrice,s=void 0===o||o,l=e.formatQty,c=e.formatDate,m=void 0===c||c,h=e.formatMi,f=e.formatTk,p=e.onRowClick,g=e.side,y=void 0===n?g.toLocaleLowerCase():n?"sell":"buy",v=(0,r.useCallback)((function(){p({price:t,side:y})}),[t,y]);return r.createElement(d.H,{className:"trade-list-item trade-list-item-"+y,onClick:v},r.createElement("div",{className:"price left"},s?f(t):t),r.createElement("div",{className:"text right"},l?h(i):i),r.createElement("div",{className:"text right"},m?(0,u.v)(new Date(a),"hh:mm:ss"):a))}));var f=function(e,t){return t[e].tradeId};const p=r.memo((function(e){var t=e.trades,n=e.loading,i=e.itemHeight,a=e.formatTk,s=e.formatMi,c=e.formatQty,d=void 0===c||c,u=e.onRowClick,p=e.headers,g=e.emptyText,y=r.useMemo((function(){return function(e){return r.createElement(h,(0,o.__assign)({formatQty:d,formatMi:s,formatTk:a,onRowClick:u},e))}}),[s,a,u,d]);return r.createElement(r.Fragment,null,r.createElement(l,{headers:p}),r.createElement(m,{trades:t,loading:n,itemHeight:i,tradeItem:y,itemKey:f,emptyText:g}))}));var g=n(38896),y=n(71318),v=n(48658);const x={pl:0,px:["0","sm"],py:"8px",width:"100%",alignItems:"center",justifyContent:"space-between","& .left":{textAlign:"left",justifyContent:"flex-start"},"& .right":{textAlign:"right",justifyContent:"flex-end"},"> div":{textAlign:"center",alignItems:"center",justifyContent:"center"}},b=r.memo((({headers:e})=>(0,i.jsx)(s.Z,Object.assign({sx:x},{children:e.map((({text:e,area:t},n)=>(0,i.jsx)(s.Z,Object.assign({className:t,sx:{userSelect:"none",height:"24px",flex:1}},{children:(0,i.jsx)(v.Z,Object.assign({title:e,variant:"layouts.ellipsis",sx:{fontSize:0,color:"t.third"}},{children:e}),void 0)}),n)))}),void 0)));var S=n(65390);const w=Math.floor(16.5),E={cursor:"pointer",fontSize:0,fontWeight:"normal",".trade-list-item":{padding:"0 12px 0 16px","& .left":{textAlign:"left",justifyContent:"flex-start"},"& .right":{textAlign:"right",justifyContent:"flex-end",color:"t.grey300"},"&-buy .price":{color:"buy"},"&-sell .price":{color:"sell"},"& .text":{color:"orderBook.rowColor"},"& .time":{color:"t.grey300"}}},j=r.memo((({trades:e,loading:t,tradeItem:n,itemHeight:o=18})=>{const s=(0,a.useMediaQuery)({query:S.is}),l=(0,r.useMemo)((()=>s?e.reverse().slice(0,w):e.reverse()),[e,s]);return(0,i.jsx)(d.a,{sx:E,dataSource:l,loading:t,itemElement:n,itemHeight:o},void 0)}));var C=n(23716);const k=({price:e})=>{C.info(e)},T=e=>`${e}`,M=(0,r.createContext)({formatTk:T,formatMi:T,onItemClick:k});var O=n(97060);r.memo((({price:e,buyerIsMaker:t,quantity:n,tradeTime:a,formatPrice:o=!0,formatQty:s=!0,formatDate:l=!0})=>{const{formatMi:c,formatTk:m,onItemClick:h}=(0,r.useContext)(M),f=t?"sell":"buy";return(0,i.jsxs)(d.H,Object.assign({className:`trade-list-item trade-list-item-${f}`,onClick:()=>{h({price:e,side:f})}},{children:[(0,i.jsx)("div",Object.assign({className:"price left",style:{flex:1}},{children:o?m(e):e}),void 0),(0,i.jsx)("div",Object.assign({className:"text right",style:{flex:1}},{children:s?c(n):n}),void 0),(0,i.jsx)("div",Object.assign({className:"text right",style:{flex:1}},{children:l?(0,u.v)(new Date(a),"hh:mm:ss"):a}),void 0)]}),void 0)})),r.memo((({headers:e,trades:t,loading:n,tradeItem:r,itemHeight:a,formatMi:o,formatTk:s,onItemClick:l=k})=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b,{headers:e},void 0),(0,i.jsx)(M.Provider,Object.assign({value:{formatMi:o,formatTk:s,onItemClick:l}},{children:(0,i.jsx)(j,{trades:t,loading:n,tradeItem:r,itemHeight:a},void 0)}),void 0)]},void 0)));var I=n(2896),D=n(23131),_=n(3638),H=n(95226),R=n(88809);const A=(e,t)=>{const{trades:n}=e,{trade:i,limit:r,fresh:a}=t.payload||{};return{update:Date.now(),trades:a?[]:n.concat(i).slice(-r)}};const N={a:"aggTradeId",f:"firstTradeId",l:"lastTradeId",p:"price",T:"tradeTime",q:"quantity",m:"buyerIsMaker"},L=({symbol:e,limit:t=80,stream:n,isDelivery:i=!1})=>{const{value:a,loading:o,updateTime:s}=function(e,t,n){const i=(0,r.useRef)(0),a=(()=>{const e=(0,r.useRef)(!1);return(0,r.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,r.useCallback)((()=>e.current),[])})(),[o,s]=(0,r.useState)(Date.now()),[l,c]=(0,r.useState)(Object.assign({loading:!0,updateTime:Date.now()},n));return(0,r.useEffect)((()=>{const t=++i.current;!1===l.loading&&c(Object.assign(Object.assign({},l),{loading:!0})),e().then((e=>{const r=null==typeof e?null==n?void 0:n.value:e;a()&&t===i.current&&c({value:r,loading:!1,error:null,updateTime:Date.now()})})).catch((e=>{a()&&t===i.current&&c(Object.assign(Object.assign({},n),{loading:!1,error:e,updateTime:Date.now()}))}))}),[...t,o]),Object.assign(Object.assign({},l),{onRefresh:()=>s(Date.now)})}((()=>{return n=void 0,r=void 0,o=function*(){const n=yield(0,H.A3)(i?R.P.DAPI:R.P.FAPI,{symbol:e,limit:t}),r=Object.keys(N);return(n||[]).map((t=>r.reduce(((e,n)=>{const i=N[n];return Object.assign(Object.assign({},e),{[i]:t[n]})}),{symbol:e})))},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{l(o.next(e))}catch(e){t(e)}}function s(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(i,s)}l((o=o.apply(n,r||[])).next())}));var n,r,a,o}),[e],{value:[]}),{update:l,trades:c}=(({symbol:e,limit:t=80,stream:n,snap:i=!0})=>{const a={update:Date.now(),trades:[]},[o,s]=(0,r.useReducer)(A,a),l=(0,r.useCallback)(((e,n)=>{const i=Array.isArray(e)?e:[e];s({payload:{trade:i,limit:t,fresh:n}})}),[s,t]);return(0,r.useEffect)((()=>{if(l([],!0),n){const t="function"==typeof n.getStreamTradeSnap&&i?"getStreamTradeSnap":"getStreamTrade";return n[t](e).subscribe((e=>{l(e,!1)}))}}),[n,e,i]),Object.assign({},o)})({symbol:e,limit:t,stream:n});return{loading:o,updateTime:s,streamTimeStamp:l,trades:[...a,...c].slice(-t)}},P=Math.floor(16.5),K=r.memo((({sx:e={}})=>{const[t,n]=(0,g.z4)(),{getI18n:o}=(0,O.ZK)("trd-trades"),{formatMi:s,formatTk:l}=(0,g.mC)(),{isCoinUnit:c}=(0,g.QV)(),{marginAsset:d,tickSize:m}=(0,g.j2)(),u=(0,_.p)(m),[h,f]=n,v=(0,r.useMemo)((()=>[{text:`${o("price",{defaultValue:"Price"})}(${f})`,area:"left"},{text:`${o("amount",{defaultValue:"Amount"})}(${c?h:d})`,area:"right"},{text:o("time",{defaultValue:"Time"}),area:"right"}]),[o,f,h,d,c]),{trades:x,loading:b}=L({symbol:t,stream:(0,D.BN)(),isDelivery:!1}),w=(0,r.useCallback)((e=>{I.ee.emit("UPDATE_ORDER_PRICE_INPUT",String(e.price))}),[]),E=(0,r.useMemo)((()=>o("common-nodata",{defaultValue:"No Data"})),[]),j=(0,a.useMediaQuery)({query:S.is}),C=(0,r.useMemo)((()=>(j?x.reverse().slice(0,P):x.slice().reverse()).map((e=>{const{quantity:t,price:n}=e,i=c?t:(0,g.WA)({quantity:t,price:n,precision:u,format:!1});return Object.assign(Object.assign({},e),{quantity:i})}))),[x,j,u]);return(0,i.jsx)(y.Z,Object.assign({sx:Object.assign({px:"0",pb:"12px",width:"100%"},e)},{children:(0,i.jsx)(p,{headers:v,trades:C,loading:b,itemHeight:20,formatMi:s,formatTk:l,formatQty:c,onRowClick:w,emptyText:E},void 0)}),void 0)}))},65390:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>m,c9:()=>s,g8:()=>l,is:()=>c});var i=n(52322),r=n(2784),a=n(62143),o=n(17160);const s="screen and (min-width: 1024px)",l="screen and (min-width: 768px) and (max-width: 1023px)",c="screen and (max-width: 767px)",d=(0,r.memo)((e=>{var{mediaQuery:t,children:n}=e,s=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["mediaQuery","children"]);const l=(0,o.useMediaQuery)({query:t||"(max-width: -1)"})||void 0===t;return(0,r.useMemo)((()=>l?(0,i.jsx)(a.Z,Object.assign({sx:{width:"100%",height:"100%",display:"none",[`@media ${t}`]:{display:"block"}}},s,{children:n}),void 0):null),[l,n,s,t])})),m=(0,r.memo)(d)},71318:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(52322),r=n(92036);function a(e){return(0,i.jsx)(r.Z,Object.assign({__css:{flexDirection:"column",height:"100%",px:"sm"}},e),void 0)}}}]);