(self.webpackChunkcloud_trade_sdk=self.webpackChunkcloud_trade_sdk||[]).push([[6137],{18495:(e,t,n)=>{"use strict";n.d(t,{a:()=>Z,H:()=>R});var i,r=n(5163),a=n(2784),s=n(13980),o=n.n(s),l=n(8301),c=n(12436),d=n.n(c),m=n(61049),u=n.n(m),h=n(18149),f=n.n(h),p=n(62143),g=n(72779),y=n.n(g),v=n(20573),x=n(7688),b=n(28316),S=n(10687),E={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},j=(0,a.memo)((function(e){var t=e.show,n=void 0===t||t,i=e.fullScreen,s=void 0!==i&&i,o=e.inner,l=e.children,c=e.zIndex;if(!n)return l||null;var d=a.createElement(S.Z,{sx:(0,r.__assign)({zIndex:c||"100"},E)});return s?a.createElement(a.Fragment,null,l,a.createElement("div",{style:{position:o?"absolute":"fixed",top:0,left:0,width:"100%",height:"100%",background:"radial-gradient(rgba(0, 0, 0, 0.05) 30%, transparent)",zIndex:2e3}},d)):a.createElement(a.Fragment,null,l,d)}));j.show=function(e){var t=(void 0===e?{}:e).fullScreen,n=void 0!==t&&t;i||(i=document.createElement("div"),document.body.appendChild(i)),b.render(a.createElement(j,{fullScreen:n}),i)},j.hide=function(){i&&b.render(a.createElement(j,{show:!1}),i)};const w=j;var C={fontSize:0,textAlign:"center",padding:"8px 6px",color:"t.third"};const k=(0,a.memo)((function(e){var t=e.children,n=(0,r.__rest)(e,["children"]);return a.createElement(p.Z,(0,r.__assign)({sx:C,className:"emptyLine"},n),t)}));var T=n(44613),M=n(74628),I=n(76699),O=function(){var e=(0,I.$)().i18n.language||"undefined"!=typeof window&&window.localStorage.i18nextLng||"en";return(0,M.yV)(e)};l.t7.displayName="FixedSizeList";var _,D,H,R=(0,a.memo)((function(e){var t=e.className,n=e.children,i=(0,r.__rest)(e,["className","children"]),s=y()("list-item-entity",t);return a.createElement(a.Fragment,null,a.createElement("div",(0,r.__assign)({className:s},i),n),a.createElement(v.xB,{styles:{".list-item-entity":{display:"flex",alignItems:"center",justifyContent:" space-between",flex:1}}}))})),A=function(){},N=(0,r.__read)([38,40],2),L=N[0],P=N[1],K=function(e){function t(t){var n,i=e.call(this,t)||this;return i.state={isScrolling:!1,isHover:!1,activeId:0,scrollOffset:0},i.renderItem=function(e){var t=e.index,n=e.style,s=i.props,o=s.dataSource,l=s.itemElement,c=s.openShotCut,d=i.state.activeId,m=!!c&&d===t;return a.createElement(a.Fragment,null,a.createElement("div",{style:n,className:"list-item-container"},a.createElement(l,(0,r.__assign)({},o[t],{activeId:d,active:m}))),a.createElement(v.xB,{styles:{".list-item-container":{display:"flex",alignItems:"center",overflowX:"hidden"}}}))},i.renderChild=function(){var e=i.props,t=e.dataSource,n=void 0===t?[]:t,s=e.itemKey,o=e.itemHeight,c=e.loading,d=void 0!==c&&c,m=e.loadWithContent,u=void 0!==m&&m,h=e.direction,f=e.listSx,p=void 0===f?{}:f,g=e.emptyText,y=e.emptyChildren,v=i.state.isScrolling,b=!d&&0===n.length;i.ListStyle=(0,r.__assign)({direction:h},p);var S=a.createElement(x.Z,{className:"list-auto-sizer"},(function(e){var t=e.width,c=e.height;return a.createElement(l.t7,{style:(0,r.__assign)({direction:h},p),className:"fixed-size-list",width:t,height:c,itemCount:n.length,itemSize:o,itemData:n,itemKey:s,overscanCount:v?10:1,outerRef:i.outerListRef,innerRef:i.innerListRef,useIsScrolling:!0},i.renderItem)}));return d?u?a.createElement(a.Fragment,null,a.createElement(w,{fullScreen:!0,inner:!0}),S):a.createElement(w,{fullScreen:!0,inner:!0}):b?a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexGrow:1}},y||(g?a.createElement(k,null,g):null)):S},i.handleScroll=d()(i.handleScroll.bind(i),200),i.handleMouseEnter=i.handleMouseEnter.bind(i),i.handleMouseLeave=i.handleMouseLeave.bind(i),i.handleKeyDown=i.handleKeyDown.bind(i),i.keyScroll=i.keyScroll.bind(i),i.outerListRef=a.createRef(null),i.innerListRef=a.createRef(null),i.maxHeight=t.itemHeight,i.minHeight=.1,i.eventAttached=!1,i.keys=((n={})[L]=0,n[P]=0,n),i}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.openShotCut&&(this.eventAttached=!0,document.addEventListener("keydown",this.handleKeyDown),this.keyScroll())},t.prototype.componentDidUpdate=function(){this.props.openShotCut&&(this.eventAttached||document.addEventListener("keydown",this.handleKeyDown),this.keyScroll())},t.prototype.componentWillUnmount=function(){this.eventAttached&&(this.eventAttached=!1,document.removeEventListener("keydown",this.handleKeyDown)),this.clearTimer()},t.prototype.shouldComponentUpdate=function(e,t){return f()(e.dataSource,this.props.dataSource)?e.loading!==this.props.loading||e.itemHeight!==this.props.itemHeight||e.listSx!==this.props.listSx:!(t.isScrolling&&this.state.isScrolling||t.isHover!==this.state.isHover)},t.prototype.handleMouseEnter=function(){this.setState({isHover:!0})},t.prototype.handleMouseLeave=function(){this.setState({isHover:!1})},t.prototype.handleScroll=function(){var e=this;this.state.isHover&&(this.setState({isScrolling:!0}),this.clearTimer(),this.timer=setTimeout((function(){e.setState({isScrolling:!1})}),1e3))},t.prototype.clearTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.handleKeyDown=function(e){var t,n=e.keyCode,i=e.metaKey,r=e.ctrlKey,a=this.props,s=a.itemHeight,o=a.dataSource,l=a.openShotCut,c=a.onKeyDownCallback,d=a.tradeType,m=this.state.activeId;if(l&&(13===n||n===L||n===P)&&(e&&e.preventDefault(),e.stopPropagation(),this.keys=((t={})[L]=Math.max(this.minHeight,this.state.scrollOffset-s),t[P]=Math.min(this.state.scrollOffset+s,this.maxHeight),t),this.keys[n]&&this.scrollItem(this.keys[n]),13===n)){var h=o.filter((function(e,t){return t===m})),f=h.length?h[0]:{};u()(c)&&c({data:f,metaKey:i,ctrlKey:r,tradeType:d})}},t.prototype.keyScroll=function(){this.innerListRef.current&&(this.maxHeight=this.innerListRef.current.style.height.replace("px","")||this.props.itemHeight),this.outerListRef.current&&this.outerListRef.current.scrollTo({left:0,top:this.state.scrollOffset,behavior:"auto"})},t.prototype.scrollItem=function(e){this.setState({activeId:Math.floor(e/this.props.itemHeight),scrollOffset:e})},t.prototype.render=function(){var e=this.props,t=e.variant,n=e.sx,i=e.tx,r=e.scrollPerf,s=void 0===r||r;return a.createElement(p.Z,{onScroll:s?this.handleScroll:A,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,__css:{position:"relative",display:"flex",flexDirection:"column",flexGrow:1},className:"list-container",variant:t,sx:n,tx:i},this.renderChild())},t.propTypes={dataSource:o().array.isRequired,itemElement:o().elementType.isRequired,itemHeight:o().number.isRequired,itemKey:o().func,sx:o().object,tx:o().string,variant:o().string,loading:o().bool,openShotCut:o().bool,onKeyDownCallback:o().func,emptyText:o().string,tradeType:o().string},t}(a.Component),Z=(D=(_=K).displayName||_.name||"Component",(H=function(e){var t,n=(t=O(),(0,T.cp)(t));return a.createElement(_,(0,r.__assign)({},e,{direction:n}))}).displayName="WithDirection("+D+")",H)},977:(e,t,n)=>{"use strict";function i(e,t,n){void 0===t&&(t="yyyy-MM-dd hh:mm"),void 0===n&&(n=!1);var i=n?{"M+":e.getUTCMonth()+1,"d+":e.getUTCDate(),"h+":e.getUTCHours(),"m+":e.getUTCMinutes(),"s+":e.getUTCSeconds(),"q+":Math.floor((e.getUTCMonth()+3)/3),S:e.getUTCMilliseconds()}:{"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},r=t;return/(y+)/.test(t)&&(r=t.replace(RegExp.$1,(""+e.getFullYear()).substr(4-RegExp.$1.length))),Object.keys(i).forEach((function(e){new RegExp("("+e+")").test(r)&&(r=r.replace(RegExp.$1,1===RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)))})),r}n.d(t,{v:()=>i})},18149:(e,t,n)=>{var i=n(88746);e.exports=function(e,t){return i(e,t)}},12436:(e,t,n)=>{var i=n(54073),r=n(29259);e.exports=function(e,t,n){var a=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return r(n)&&(a="leading"in n?!!n.leading:a,s="trailing"in n?!!n.trailing:s),i(e,t,{leading:a,maxWait:t,trailing:s})}},46137:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>q});var i=n(52322),r=n(2784),a=n(17160),s=n(5163),o=n(92036),l=n(48658),c=[70,75,60],d=function(e){return(c[e]||0)+"px"};const m=r.memo((function(e){var t=e.headers;return r.createElement(o.Z,{sx:{alignItems:"center",justifyContent:"space-between","& .left":{textAlign:"left",justifyContent:"flex-start"},"& .right":{textAlign:"right",justifyContent:"flex-end"},"> div":{textAlign:"center",alignItems:"center",justifyContent:"center"},px:["0","sm"],py:"8px"}},t.map((function(e,t){return r.createElement(o.Z,{key:t,className:e.area,sx:{userSelect:"none",height:"16px"},style:{minWidth:d(t)}},r.createElement(l.Z,{title:e.text,sx:{fontSize:0,color:"t.third"}},e.text))})))}));var u={"& .trade-list-item":{padding:"0 12px 0 16px !important",cursor:"pointer",fontSize:0,fontWeight:"normal","& .left":{textAlign:"left",justifyContent:"flex-start"},"& .right":{textAlign:"right",justifyContent:"flex-end",color:"t.secondary"},"&-buy .price":{color:"t.buy"},"&-sell .price":{color:"t.sell"},"& .text":{color:"t.secondary"},"& .time":{color:"t.secondary"},"@media screen and (max-width: 768px)":{padding:"0 !important"}}},h=n(18495);const f=r.memo((function(e){var t=e.trades,n=e.loading,i=e.itemHeight,a=void 0===i?18:i,s=e.tradeItem,o=e.emptyText;return r.createElement(h.a,{sx:u,dataSource:t,loading:n,itemElement:s,itemHeight:a,emptyText:o})}));var p=n(977);const g=r.memo((function(e){var t=e.price,n=e.buyerIsMaker,i=e.quantity,a=e.tradeTime,s=e.formatPrice,o=void 0===s||s,l=e.formatQty,c=e.formatDate,m=void 0===c||c,u=e.formatMi,f=e.formatTk,g=e.onRowClick,y=e.side,v=void 0===n?y.toLocaleLowerCase():n?"sell":"buy",x=(0,r.useCallback)((function(){g({price:t,side:v})}),[t,v]);return r.createElement(h.H,{className:"trade-list-item trade-list-item-"+v,onClick:x},r.createElement("div",{className:"price left",style:{minWidth:d(0)}},o?f(t):t),r.createElement("div",{className:"text right",style:{minWidth:d(1)}},l?u(i):i),r.createElement("div",{className:"text right",style:{minWidth:d(2)}},m?(0,p.v)(new Date(a),"hh:mm:ss"):a))}));var y=function(e,t){return t[e].tradeId};const v=r.memo((function(e){var t=e.trades,n=e.loading,i=e.itemHeight,a=e.formatTk,o=e.formatMi,l=e.formatQty,c=void 0===l||l,d=e.onRowClick,u=e.headers,h=e.emptyText,p=r.useMemo((function(){return function(e){return r.createElement(g,(0,s.__assign)({formatQty:c,formatMi:o,formatTk:a,onRowClick:d},e))}}),[o,a,d,c]);return r.createElement(r.Fragment,null,r.createElement(m,{headers:u}),r.createElement(f,{trades:t,loading:n,itemHeight:i,tradeItem:p,itemKey:y,emptyText:h}))}));var x=n(38896),b=n(71318);const S={pl:0,px:["0","sm"],py:"8px",width:"100%",alignItems:"center",justifyContent:"space-between","& .left":{textAlign:"left",justifyContent:"flex-start"},"& .right":{textAlign:"right",justifyContent:"flex-end"},"> div":{textAlign:"center",alignItems:"center",justifyContent:"center"}},E=r.memo((({headers:e})=>(0,i.jsx)(o.Z,Object.assign({sx:S},{children:e.map((({text:e,area:t},n)=>(0,i.jsx)(o.Z,Object.assign({className:t,sx:{userSelect:"none",height:"24px",flex:1}},{children:(0,i.jsx)(l.Z,Object.assign({title:e,variant:"layouts.ellipsis",sx:{fontSize:0,color:"t.third"}},{children:e}),void 0)}),n)))}),void 0)));var j=n(65390);const w=Math.floor(16.5),C={cursor:"pointer",fontSize:0,fontWeight:"normal",".trade-list-item":{padding:"0 12px 0 16px","& .left":{textAlign:"left",justifyContent:"flex-start"},"& .right":{textAlign:"right",justifyContent:"flex-end",color:"t.grey300"},"&-buy .price":{color:"buy"},"&-sell .price":{color:"sell"},"& .text":{color:"orderBook.rowColor"},"& .time":{color:"t.grey300"}}},k=r.memo((({trades:e,loading:t,tradeItem:n,itemHeight:s=18})=>{const o=(0,a.useMediaQuery)({query:j.is}),l=(0,r.useMemo)((()=>o?e.reverse().slice(0,w):e.reverse()),[e,o]);return(0,i.jsx)(h.a,{sx:C,dataSource:l,loading:t,itemElement:n,itemHeight:s},void 0)}));var T=n(23716);const M=({price:e})=>{T.info(e)},I=e=>`${e}`,O=(0,r.createContext)({formatTk:I,formatMi:I,onItemClick:M});var _=n(97060);r.memo((({price:e,buyerIsMaker:t,quantity:n,tradeTime:a,formatPrice:s=!0,formatQty:o=!0,formatDate:l=!0})=>{const{formatMi:c,formatTk:d,onItemClick:m}=(0,r.useContext)(O),u=t?"sell":"buy";return(0,i.jsxs)(h.H,Object.assign({className:`trade-list-item trade-list-item-${u}`,onClick:()=>{m({price:e,side:u})}},{children:[(0,i.jsx)("div",Object.assign({className:"price left",style:{flex:1}},{children:s?d(e):e}),void 0),(0,i.jsx)("div",Object.assign({className:"text right",style:{flex:1}},{children:o?c(n):n}),void 0),(0,i.jsx)("div",Object.assign({className:"text right",style:{flex:1}},{children:l?(0,p.v)(new Date(a),"hh:mm:ss"):a}),void 0)]}),void 0)})),r.memo((({headers:e,trades:t,loading:n,tradeItem:r,itemHeight:a,formatMi:s,formatTk:o,onItemClick:l=M})=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(E,{headers:e},void 0),(0,i.jsx)(O.Provider,Object.assign({value:{formatMi:s,formatTk:o,onItemClick:l}},{children:(0,i.jsx)(k,{trades:t,loading:n,tradeItem:r,itemHeight:a},void 0)}),void 0)]},void 0)));var D=n(2896),H=n(23131),R=n(3638),A=n(95226),N=n(88809);const L=(e,t)=>{const{trades:n}=e,{trade:i,limit:r,fresh:a}=t.payload||{};return{update:Date.now(),trades:a?[]:n.concat(i).slice(-r)}};const P={a:"aggTradeId",f:"firstTradeId",l:"lastTradeId",p:"price",T:"tradeTime",q:"quantity",m:"buyerIsMaker"},K=({symbol:e,limit:t=80,stream:n,isDelivery:i=!1})=>{const{value:a,loading:s,updateTime:o}=function(e,t,n){const i=(0,r.useRef)(0),a=(()=>{const e=(0,r.useRef)(!1);return(0,r.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,r.useCallback)((()=>e.current),[])})(),[s,o]=(0,r.useState)(Date.now()),[l,c]=(0,r.useState)(Object.assign({loading:!0,updateTime:Date.now()},n));return(0,r.useEffect)((()=>{const t=++i.current;!1===l.loading&&c(Object.assign(Object.assign({},l),{loading:!0})),e().then((e=>{const r=null==typeof e?null==n?void 0:n.value:e;a()&&t===i.current&&c({value:r,loading:!1,error:null,updateTime:Date.now()})})).catch((e=>{a()&&t===i.current&&c(Object.assign(Object.assign({},n),{loading:!1,error:e,updateTime:Date.now()}))}))}),[...t,s]),Object.assign(Object.assign({},l),{onRefresh:()=>o(Date.now)})}((()=>{return n=void 0,r=void 0,s=function*(){const n=yield(0,A.A3)(i?N.P.DAPI:N.P.FAPI,{symbol:e,limit:t}),r=Object.keys(P);return(n||[]).map((t=>r.reduce(((e,n)=>{const i=P[n];return Object.assign(Object.assign({},e),{[i]:t[n]})}),{symbol:e})))},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(i,o)}l((s=s.apply(n,r||[])).next())}));var n,r,a,s}),[e],{value:[]}),{update:l,trades:c}=(({symbol:e,limit:t=80,stream:n,snap:i=!0})=>{const a={update:Date.now(),trades:[]},[s,o]=(0,r.useReducer)(L,a),l=(0,r.useCallback)(((e,n)=>{const i=Array.isArray(e)?e:[e];o({payload:{trade:i,limit:t,fresh:n}})}),[o,t]);return(0,r.useEffect)((()=>{if(l([],!0),n){const t="function"==typeof n.getStreamTradeSnap&&i?"getStreamTradeSnap":"getStreamTrade";return n[t](e).subscribe((e=>{l(e,!1)}))}}),[n,e,i]),Object.assign({},s)})({symbol:e,limit:t,stream:n});return{loading:s,updateTime:o,streamTimeStamp:l,trades:[...a,...c].slice(-t)}},Z=Math.floor(16.5),q=r.memo((({sx:e={}})=>{const[t,n]=(0,x.z4)(),{getI18n:s}=(0,_.ZK)("trd-trades"),{formatMi:o,formatTk:l}=(0,x.mC)(),{isCoinUnit:c}=(0,x.QV)(),{marginAsset:d,tickSize:m}=(0,x.j2)(),u=(0,R.p)(m),[h,f]=n,p=(0,r.useMemo)((()=>[{text:`${s("price",{defaultValue:"Price"})}(${f})`,area:"left"},{text:`${s("amount",{defaultValue:"Amount"})}(${c?h:d})`,area:"right"},{text:s("time",{defaultValue:"Time"}),area:"right"}]),[s,f,h,d,c]),{trades:g,loading:y}=K({symbol:t,stream:(0,H.BN)(),isDelivery:!1}),S=(0,r.useCallback)((e=>{D.ee.emit("UPDATE_ORDER_PRICE_INPUT",String(e.price))}),[]),E=(0,r.useMemo)((()=>s("common-nodata",{defaultValue:"No Data"})),[]),w=(0,a.useMediaQuery)({query:j.is}),C=(0,r.useMemo)((()=>(w?g.reverse().slice(0,Z):g.slice().reverse()).map((e=>{const{quantity:t,price:n}=e,i=c?t:(0,x.WA)({quantity:t,price:n,precision:u,format:!1});return Object.assign(Object.assign({},e),{quantity:i})}))),[g,w,u]);return(0,i.jsx)(b.Z,Object.assign({sx:Object.assign({px:"0",pb:"12px",width:"100%"},e)},{children:(0,i.jsx)(v,{headers:p,trades:C,loading:y,itemHeight:20,formatMi:o,formatTk:l,formatQty:c,onRowClick:S,emptyText:E},void 0)}),void 0)}))},65390:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>m,c9:()=>o,g8:()=>l,is:()=>c});var i=n(52322),r=n(2784),a=n(62143),s=n(17160);const o="screen and (min-width: 1024px)",l="screen and (min-width: 768px) and (max-width: 1023px)",c="screen and (max-width: 767px)",d=(0,r.memo)((e=>{var{mediaQuery:t,children:n}=e,o=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["mediaQuery","children"]);const l=(0,s.useMediaQuery)({query:t||"(max-width: -1)"})||void 0===t;return(0,r.useMemo)((()=>l?(0,i.jsx)(a.Z,Object.assign({sx:{width:"100%",height:"100%",display:"none",[`@media ${t}`]:{display:"block"}}},o,{children:n}),void 0):null),[l,n,o,t])})),m=(0,r.memo)(d)},71318:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(52322),r=n(92036);function a(e){return(0,i.jsx)(r.Z,Object.assign({__css:{flexDirection:"column",height:"100%",px:"sm"}},e),void 0)}}}]);